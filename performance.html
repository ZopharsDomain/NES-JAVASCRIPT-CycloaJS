<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<script type="text/javascript" src="js/cycloa/cycloa.js"></script>
	<script type="text/javascript" src="js/cycloa/err.js"></script>
	<script type="text/javascript" src="js/cycloa/util.js"></script>
	<script type="text/javascript" src="js/cycloa/fast.js"></script>
	<script type="text/javascript" src="js/cycloa/trace.js"></script>
	<script type="text/javascript" src="test/test_rom.js"></script>
	<script>
		function runMany(){
			for(var i=0;i<1;++i){
				measurePerformance();
			}
		}

		function measurePerformance(){
			var machine = new cycloa.FastMachine(TestROM.buffer);
			var tracer = new cycloa.Tracer(machine);
			var start = new Date();
			var clock = 0;
			
			for(var i = 0; i < 1; ++i){
				machine.onHardReset();
				for(var t = 0; t < 500000; ++t){
					//console.log(tracer.decode());
					clock += machine.run();
				}
			}
			var end = new Date();
			var time = (end-start);
			document.getElementById('console').innerHTML = "nclocks: "+clock+" /time: "+time+"ms / "+(clock/time/1000)+"MHz";
		}
	</script>
	<title>unit test</title>
</head>
<body>
	<input id="start" onclick="runMany()" type="button" value="start" />
	<div id="console"></div>
</body>
</html>
